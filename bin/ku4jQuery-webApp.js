(function(f){$=f;$.ku4webApp={};function a(k){a.base.call(this);$.list(k).each(this._add,this)}a.prototype={_add:function(k){var l=$[k.type](k.selector);if($.exists(k.spec)){l.spec(k.spec)}if(k.required&&$.exists(l.required)){l.required()}this.add(l.dom().name,l)}};$.Class.extend(a,$.form.Class);$.ku4webApp.form=function(k){return new a(k)};function e(k){this._container=$(k);this._display="css-responsebox-show"}e.prototype={show:function(k){this._container.html(k).addClass(this._display)},hide:function(){this._container.html("").removeClass(this._display)}};$.ku4webApp.responsebox=function(k){return new e(k)};function h(k){this._config=k}h.prototype={validate:function(n){var l=this._config,o=true,m=$.hash({}),k=n.fields();$.list(l).each(function(r){var p=r.name,q=r.message,s=k.find(p);if(!$.exists(s)||s.isValid()){return}o=false;m.add(p,q)});return{isValid:o,messages:m.toObject()}}};$.ku4webApp.validator=function(k){return new h(k)};function g(m,l,k){this._mediator=m;this._serviceFactory=l;this._formFactory=k}g.prototype={$mediator:function(){return this._mediator},$serviceFactory:function(){return this._serviceFactory},$formFactory:function(){return this._formFactory}};$.ku4webApp.controller=g;function d(l,k){this._mediator=l;this._config=k}d.prototype={$call:function(n,k,m,l){$.service()[n]().uri(this._config[k]).onSuccess(function(o){var p=$.dto.parseJson(o).toObject();if(p.isError){this._mediator.notify(p,"error")}else{this._mediator.notify(p.data,m)}},this).onError(function(o){this._mediator.notify(o,"error")},this).call(l);return this}};$.ku4webApp.service=d;function j(k){this._templates=k}j.prototype={$templates:function(){return this._templates},$render:function(k,l){return $.str.render(k,l)},$renderList:function(m,l){var k="";$.list(l).each(function(n){k+=this.$render(m,n)},this);return k},$renderWithAction:function(l,k){return k.call(this,l)},$renderListWithAction:function(l,m){var k="";$.list(l).each(function(n){k+=this.$renderWithAction(n,m)},this);return k}};$.ku4webApp.template=j;function b(m,k,l){this._mediator=m;this._responsebox=k;this._templateFactory=l}b.prototype={$mediator:function(){return this._mediator},$responsebox:function(){return this._responsebox},$templateFactory:function(){return this._templateFactory}};$.ku4webApp.view=b;function i(k){this._config=k}i.prototype={$create:function(k){return $.ku4webApp.form(this._config[k])}};$.ku4webApp.formFactory=i;function c(l,k){this._mediator=l;this._config=k}c.prototype={$mediator:function(){return this._mediator},$config:function(){return this._config}};$.ku4webApp.serviceFactory=c})(jQuery);