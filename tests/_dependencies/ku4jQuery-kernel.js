(function(M){$=M;$.isArray=function(l){return l instanceof Array};$.isBool=function(l){return(/boolean/i.test(typeof(l)))};$.isDate=function(l){return l instanceof Date};$.isEvent=function(l){try{return l instanceof Event}catch(V){return l===window.event}};$.isNumber=function(l){return((/number/i.test(typeof(l)))||l instanceof Number)&&!isNaN(l)};$.isObject=function(l){return $.exists(l)&&(/object/i.test(typeof(l)))&&!($.isBool(l)||$.isNumber(l)||$.isDate(l)||$.isArray(l)||$.isString(l)||$.isFunction(l))};$.isFunction=function(l){return(l instanceof Function)};$.isString=function(l){return(/string/i.test(typeof(l)))||l instanceof String};$.isZero=function(l){return l===0};$.isEven=function(l){return($.isNullOrEmpty(l)||$.isDate(l))?false:(isNaN(l)?false:($.isZero(l)?false:l%2===0))};$.isOdd=function(l){return($.isNullOrEmpty(l)||$.isDate(l))?false:(isNaN(l)?false:($.isZero(l)?false:!$.isEven(l)))};$.isNull=function(l){return l===null};$.isUndefined=function(l){return(/undefined/i.test(typeof(l)))};$.isEmpty=function(l){return $.isString(l)&&$.isZero(l.split(/\B/).length)};$.isNullOrEmpty=function(l){return !$.exists(l)||$.isEmpty(l)};$.exists=function(l){return(l!==null)&&(!$.isUndefined(l))};$.areEqual=function(V,l){if(this.exists(V)&&this.exists(l)){if(this.exists(V.equals)&&value.equals(l)){return true}if(this.exists(V.getTime)&&this.exists(l.getTime)&&V.getTime()==l.getTime()){return true}if(V===l){return true}else{return V===l}}else{return V===l}};$.xor=function(V,l){return !V!=!l};function q(V,W,l,Y){var X="ku4EXCEPTION @ {0}: {1}\n\nBrowser Stack Trace:\n{2}\n\nku4Trace:\n{3}";return new Error($.str.format(X,V.toUpperCase(),W,l,Y))}$.ku4exception=function(W,X){var V=arguments.callee.caller,Y="",l="";(function(){try{generate.exeception}catch(ab){l=($.exists(ab.stack))?ab.stack.replace(/generate is.+/,""):"[Unavailable]";var aa=0,ac,Z;while(V&&(aa<10)){ac=V.toString().replace(/[\n\t\r\s]+/g," ").substring(0,100);Z=ac.replace(/\W/g,"a").replace(/\s/g,"").replace(/.*base\.js:216/,"").split(/\B/).length>99?ac+"...":ac;Y+=$.str.format("<ku4Idx[{0}]>:{1}\n",aa,Z);V=V.caller;aa++}}})();return q(W,X,l,Y)};$.ku4Log=function(){try{console.log.apply(console,arguments)}catch(l){alert(Array.prototype.slice.call(arguments).join("\n"))}};$.replicate=function(W){var l=($.isDate(W))?new Date(W):($.isArray(W))?[]:($.isObject(W))?{}:W,V;for(n in W){V=W[n];l[n]=(($.isArray(V))||($.isObject(V)))?$.replicate(V):V}return l};if(!$.exists($.obj)){$.obj={}}$.obj.keys=function(V){var l=[];for(n in V){l[l.length]=n}return l};$.obj.values=function(V){var l=[];for(n in V){l[l.length]=V[n]}return l};$.obj.count=function(l){var V=0;for(n in l){V++}return V};$.obj.hasProp=function(l,V){return($.exists(l.hasOwnProperty))?l.hasOwnProperty(V):false};$.obj.merge=function(V,l){var W=$.replicate(l);for(n in V){W[n]=V[n]}return W};$.obj.meld=function(W,V){var l=$.replicate(V);for(n in W){if($.exists(l[n])){continue}l[n]=W[n]}return l};$.obj.filter=function(){var l=Array.prototype.slice.call(arguments),X={},Y=l[0],W=l.slice(1);for(var Z in W){var V=W[Z];X[V]=Y[V]}return X};$.Class=function(){};$.Class.prototype={get:function(l){return this["_"+l]},set:function(V,l){this["_"+V]=l;return this},property:function(V,l){return($.isUndefined(l))?this.get(V):this.set(V,l)},isTypeOf:function(l){return this instanceof l}};$.Class.extend=function(V,l){if(!V||!l){return null}var W=function(){};W.prototype=l.prototype;V.base=l;V.prototype=$.obj.merge(V.prototype,new W());V.prototype.constructor=V;return V};function d(l){d.base.call(this);this._isLocked=l||false}d.prototype={isLocked:function(){return this.get("isLocked")},lock:function(){this._isLocked=true;return this},unlock:function(){this._isLocked=false;return this}};$.Class.extend(d,$.Class);$.lock=function(l){return new d(l)};if(!$.exists($.math)){$.math={}}$.math.round=function(X,W){var V=W||0,l=Math.pow(10,-V);return Math.round(parseFloat((X*l).toFixed(Math.abs(V))))/l};$.math.roundUp=function(X,W){var V=W||0,l=5*(Math.pow(10,V-1));return $.math.round(X+l,W)};$.math.roundDown=function(X,W){var V=W||0,l=5*(Math.pow(10,V-1));return $.math.round(X-l,W)};$.math.factorial=function(W){var l=W,V=W;while(V--){if(!!V){l*=V}}return l};$.math.divide=function(V,l){var W=$.isNumber(V)&&$.isNumber(l)&&!$.isZero(l);if(!W){throw $.ku4exception("$.math",$.str.format("Invalid division. value: {0}/{1} | type: {2}/{3}",V,l,typeof V,typeof l))}return V/l};if(!$.exists($.str)){$.str={}}var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";$.str.build=function(){return"".concat.apply(new String(),arguments)};$.str.format=function(){var X=arguments,Z=X[0],W=X.length,V,Y;for(i=1;i<W;i++){V=X[i];Y=($.isNull(V))?"null":($.isUndefined(V))?"undefined":V.toString();Z=Z.replace(RegExp("\\{"+(i-1)+"\\}","g"),Y)}return Z};$.str.render=function(V,X,W){var l=""+V;for(var Y in X){l=l.replace(RegExp("\\{{"+Y+"\\}}","g"),X[Y])}return $.exists(W)?l.replace(/\{\{.*\}\}/g,W):l};$.str.parse=function(){return String.fromCharCode.apply(String,arguments)};$.str.trim=function(l){return $.str.trimStart($.str.trimEnd(l))};$.str.trimStart=function(l){if(!$.isString(l)){throw new Error("Cannot trim non-string values")}return($.exists(l.replace))?l.replace(/^\s*\b/,""):l};$.str.trimEnd=function(l){if(!$.isString(l)){throw new Error("Cannot trim non-string values")}return($.exists(l.replace))?l.replace(/\b\s*$/,""):l};$.str.encodeBase64=function(X){var Y="",W=0,af=$.str.encodeUtf8(X),ag,ad,ab,ae,ac,aa,Z,l=function(ah){return af.charCodeAt(ah)},V=function(ah){return Q.charAt(ah)};while(W<af.length){ag=l(W++);ad=l(W++);ab=l(W++);ae=ag>>2;ac=((ag&3)<<4)|(ad>>4);aa=((ad&15)<<2)|(ab>>6);Z=ab&63;if(isNaN(ad)){aa=Z=64}else{if(isNaN(ab)){Z=64}}Y+=(V(ae)+V(ac)+V(aa)+V(Z))}return Y};$.str.decodeBase64=function(X){var Y="",W=0,af=X.replace(/[^A-Za-z0-9\+\/\=]/g,""),ag,ad,ab,ae,ac,aa,Z,V=function(ah){return Q.indexOf(af.charAt(ah))},l=function(ah){return String.fromCharCode(ah)};while(W<af.length){ae=V(W++);ac=V(W++);aa=V(W++);Z=V(W++);ag=(ae<<2)|(ac>>4);ad=((ac&15)<<4)|(aa>>2);ab=((aa&3)<<6)|Z;Y+=l(ag);if(aa!=64){Y+=l(ad)}if(Z!=64){Y+=l(ab)}}return $.str.decodeUtf8(Y)};$.str.encodeUtf8=function(l){var Z="",X=l.replace(/\r\n/g,"\n"),Y=function(ab){return X.charCodeAt(ab)},W=function(ab){return String.fromCharCode(ab)};for(var V=0;V<X.length;V++){var aa=Y(V);if(aa<128){Z+=W(aa)}else{if((aa>127)&&(aa<2048)){Z+=(W((aa>>6)|192)+W((aa&63)|128))}else{Z+=W((aa>>12)|224)+W(((aa>>6)&63)|128)+W((aa&63)|128)}}}return Z};$.str.decodeUtf8=function(aa){var ab="",Y=0,Z=0,X=0,W=0,ac=aa,l=function(ad){return ac.charCodeAt(ad)},V=function(ad){return String.fromCharCode(ad)};while(Y<ac.length){Z=l(Y);if(Z<128){ab+=V(Z);Y++}else{if((Z>191)&&(Z<224)){X=l(Y+1);ab+=V(((Z&31)<<6)|(X&63));Y+=2}else{X=l(Y+1);W=l(Y+2);ab+=V(((Z&15)<<12)|((X&63)<<6)|(W&63));Y+=3}}}return ab};$.uid=function(){var V=Math.random().toString().replace(/\b\.\b/,""),l=Math.random().toString().replace(/\b\.\b/,"");return $.str.encodeBase64($.str.format("{0}x{1}",V,l)).replace(/=+/g,"0").substr(3,32)};function e(W,l,V){e.base.call(this);this._username=W;this._domain=l;this._topLevelDomain=V}e.prototype={username:function(){return this._username},domain:function(){return this._domain},topLevelDomain:function(){return this._topLevelDomain},equals:function(l){if(!$.exists(l)){return false}return l.username()==this._username&&l.domain()==this._domain&&l.topLevelDomain()==this._topLevelDomain},toString:function(){return $.str.format("{0}@{1}.{2}",this._username,this._domain,this._topLevelDomain)}};$.Class.extend(e,$.Class);$.emailAddress=function(W,l,V){return new e(W,l,V)};$.emailAddress.Class=e;$.emailAddress.parse=function(X){if(!($.exists(X))&&/@{1}/.test(X)){return null}var W=X.split("@"),l=W[1],V=l.split("."),Y=W[0];topLevelDomain=V.splice(V.length-1,1),domain=V.join(".");return new e(Y,domain,topLevelDomain)};function g(l){g.base.call(this);this._value=l}g.prototype={value:function(){return this._value},equals:function(l){if(!$.exists(l)){return false}return l.value()==this._value},toStringWithFormat:function(V){var l=V;$.list((this._value.toString().split(""))).each(function(W){l.replace("#",W)});return l.replace(/#/g,"")}};$.Class.extend(g,$.Class);$.phoneNumber=function(l){return new g(l)};$.phoneNumber.Class=g;$.phoneNumber.parse=function(l){return new g(parseInt(l.replace(/[^0-9]/gi,"")))};function N(W,l,V){N.base.call(this);this._first=W;this._middle=l||"";this._last=V}N.prototype={first:function(){return this._first},middle:function(){return this._middle},last:function(){return this._last},full:function(){var l=($.isNullOrEmpty(this._middle))?"{F} {L}":"{F} {M} {L}";return this.toStringWithFormat(l)},initials:function(){var l=($.isNullOrEmpty(this._middle))?"{f}.{l}.":"{f}.{m}.{l}.";return this.toStringWithFormat(l)},equals:function(l){if(!$.exists(l)){return false}return l.first()==this._first&&l.middle()==this._middle&&l.last()==this._last},toStringWithFormat:function(W){var l=this._first.charAt(0),V=this._middle.charAt(0),X=this._last.charAt(0);return W.replace("{F}",this._first).replace("{M}",this._middle).replace("{L}",this._last).replace("{f}",l).replace("{m}",V).replace("{l}",X)}};$.Class.extend(N,$.Class);$.properName=function(W,l,V){return new N(W,l,V)};$.properName.Class=N;function L(l){L.base.call(this);this.$h={};this._count=0;var V=($.exists(l)&&$.exists(l.toObject))?l.toObject():l;for(var W in V){this.add(W,V[W])}}L.prototype={count:function(){return this.get("count")},keys:function(){return $.obj.keys(this.$h)},values:function(){return $.obj.values(this.$h)},add:function(V,l){if((!($.isString(V)||$.isNumber(V)))||/(^null$)|(^undefined$)/.test(V)||this.containsKey(V)){throw $.ku4exception("$.hash",$.str.format("Invalid key: {0}. Must be unique number or string.",V))}if($.isUndefined(l)){return}this.$h[V]=l;this._count++;return this},clear:function(){var l=this.$h;for(n in l){delete l[n]}this._count=0;return this},find:function(l){if(!$.exists(l)){return null}return this.$h[l]},findKey:function(l){var V=this.$h;for(n in V){if($.areEqual(V[n],l)){return n}}return null},findValue:function(l){return this.find(l)},quit:function(){this._iterator.quit();return this},each:function(V,l){var W=l||this;this._iterator=$.iterator(this.toObject());this._iterator.each(V,W);return this},isEmpty:function(){return this._count<1},contains:function(l){if(!$.exists(l)||$.isNullOrEmpty(l)||$.hash(l).isEmpty()){return false}var W=$.exists(l.toObject)?l:$.hash(l),V=true;W.each(function(Y){if(!$.exists(Y)){V=false;W.quit()}else{var X=Y.key;V=this.containsKey(X)&&$.areEqual(this.findValue(X),Y.value);if(!V){W.quit()}}},this);return V},containsKey:function(l){if(!$.exists(l)){return false}return !$.isUndefined(this.$h[l])},containsValue:function(V){var l=$.obj.values(this.$h),W=l.length;while(W--){if($.areEqual(l[W],V)){return true}}return false},merge:function(l){return K(this,l,"merge")},meld:function(l){return K(this,l,"meld")},filter:function(){var l=[this.$h].concat(Array.prototype.slice.call(arguments));return $.hash($.obj.filter.apply($.obj,l))},remove:function(l){if(!this.containsKey(l)){return this}var V=this.$h;V[l]="value";delete V[l];this._count--;return this},replicate:function(){return $.hash($.replicate(this.$h))},toObject:function(){return this.$h},update:function(V,l){if(!$.exists(V)){return this}if(!this.containsKey(V)){this._count++}this.$h[V]=l;return this}};$.Class.extend(L,$.Class);function K(W,V,l){var X=(!V.toObject)?V:V.toObject();W.$h=$.obj[l](X,W.$h);W._count=$.obj.count(W.$h);return W}$.hash=function(l){return new L(l)};$.hash.Class=L;function w(W){w.base.call(this);this._keys=[];this._hash=$.hash();this._count=this._keys.length;if(!$.exists(W)){return}var Y=0,V=W.length;while(Y<V){var X=W[Y];if(!$.isUndefined(X)){this.add(X)}Y++}}w.prototype={count:function(){return this.get("count")},add:function(V){var l=this._keys,W=$.uid();l[l.length]=W;this._hash.add(W,V);this._count=this._keys.length;return this},clear:function(){this._hash.clear();this._keys=[];this._count=this._keys.length;return this},contains:function(l){return this._hash.containsValue(l)},find:function(V){var l=this._keys;return($.exists(l[V]))?this._hash.find(l[V]):null},quit:function(){this._iterator.quit();return this},each:function(V,l){var W=l||this;this._iterator=$.iterator(this.toArray());this._iterator.each(V,W);return this},isEmpty:function(){return this._count<1},remove:function(W){var V=this._hash;if(!this.contains(W)){return this}var l=V.findKey(W);this._keys.splice(l,1);V.remove(l);this._count=V.count();return this},toArray:function(){var l=[];this._hash.each(function(V){l.push(V.value)});return l}};$.Class.extend(w,$.Class);$.list=function(l){return new w(l)};$.list.Class=w;$.list.parseArguments=function(l){return new w(Array.prototype.slice.call(l))};function P(Z,X,l,aa,W,ab,V){P.base.call(this);if((X<1)||(X>12)){throw $.ku4exception("$.dayPoint",$.str.format("Invalid month= {0}",X))}if((l<1)||(l>T(X,Z))){throw $.ku4exception("$.dayPoint",$.str.format("Invalid date= {0}",l))}this._value=(arguments.length>=3)?new Date(Z,X-1,l,aa||0,W||0,ab||0,V||0):new Date();var ac=this._value;function ad(ae){return ae<10?"0"+ae:""+ae}this._day=ac.getDay();this._date=l;this._month=X;this._year=Z;this._hour=ad(ac.getHours());this._minute=ad(ac.getMinutes());this._second=ad(ac.getSeconds());this._millisecond=ad(ac.getMilliseconds());var Y=this._day;this._isWeekday=Y>0&&Y<6;this._isWeekend=!this._isWeekday}P.prototype={value:function(){return this._value},day:function(){return this._day},date:function(){return this._date},month:function(){return this._month},year:function(){return this._year},shortYear:function(){var l=this._year.toString();return parseInt(l.substr(l.length-2))},hour:function(){return this._hour},minute:function(){return this._minute},second:function(){return this._second},millisecond:function(){return this._millisecond},isWeekday:function(){return this._isWeekday},isWeekend:function(){return this._isWeekend},nextDay:function(){return U(this,1,0,0)},prevDay:function(){return U(this,-1,0,0)},nextMonth:function(){return U(this,0,1,0)},prevMonth:function(){return U(this,0,-1,0)},nextYear:function(){return U(this,0,0,1)},prevYear:function(){return U(this,0,0,-1)},add:function(Z,l,ae){function ad(ag,ak,aj){var ah=ag,ai=ak;while(ai--){ah=ah[aj]()}return ah}var ac=Z<0,af=Math.abs,ab=af(Z),aa=af(ae),W=af(l),V=ac?"prevYear":"nextYear",Y=ac?"prevDay":"nextDay",X=ac?"prevMonth":"nextMonth";return ad(ad(ad(this,ab,V),W,X),aa,Y)},firstDayOfMonth:function(){return new P(this._year,this._month,1)},lastDayOfMonth:function(){return new P(this._year,this._month,T(this._month,this._year))},isBefore:function(l){return !(this.isAfter(l)||this.equals(l))},isAfter:function(V){var l=this._year,X=V.year(),W=this._month,Y=V.month();if(l>X){return true}if((l==X)&&(W>Y)){return true}return((l==X)&&(W==Y)&&(this._date>V.date()))},equals:function(l){return(this._year==l.year())&&(this._month==l.month())&&(this._date==l.date())},toString:function(){return this.toStringWithFormat("mm/dd/yyyy")},toStringWithFormat:function(X){var aa=(/y{3,}/i.test(X))?this._year:this.shortYear(),l=this._month,Z=this._date,W="{0}",V=(/m{2}/i.test(X)&&l<10)?"0{1}":"{1}",Y=(/d{2}/i.test(X)&&Z<10)?"0{2}":"{2}";f=X.replace(/y{1,}/gi,W).replace(/m{1,}/gi,V).replace(/d{1,}/gi,Y);return $.str.format(f,aa,l,Z)},toDate:function(){return this.value()},toJson:function(){return this.value().toJSON()}};$.Class.extend(P,$.Class);$.dayPoint=function(Y,Z,W,l,X,aa,V){if(!($.isDate(Y)||($.isNumber(Y)&&$.isNumber(Z)&&$.isNumber(W)))){return null}return new P(Y,Z,W,l,X,aa,V)};$.dayPoint.Class=P;$.dayPoint.canParse=function(l){return($.isString(l)||$.isNumber(l)||$.isDate(l))?!isNaN(new Date(l).valueOf()):false};$.dayPoint.parse=function(ab){if(ab instanceof P){return ab}if(!($.isDate(ab)||this.canParse(ab))){return null}var l=new Date(ab),aa=l.getFullYear(),W=l.getMonth()+1,Z=l.getDate(),X=l.getHours(),Y=l.getMinutes(),ac=l.getSeconds(),V=l.getMilliseconds();return $.dayPoint(aa,W,Z,X,Y,ac,V)};$.dayPoint.tryParse=function(l){return $.dayPoint.canParse(l)?$.dayPoint.parse(l):null};var J;$.dayPoint.assumeNow=function(l){J=$.dayPoint.parse(l)};$.dayPoint.today=function(){return J||$.dayPoint.parse(new Date())};function T(W,V){var l=W,X=V;if(l==2){return(u(X))?29:28}return(((l<8)&&($.isEven(l)))||((l>7)&&($.isOdd(l))))?30:31}function u(l){var W=l.toString().split(/\B/),V=parseFloat($.str.build(W[W.length-2],W[W.length-1]));return(V%4==0)}function U(aa,af,W,ah){var aj=aa.month(),ab=aa.year(),Y=aa.date(),l=T(aj,ab),ai=af,Z=W,ae=ah,V=Y+ai,ad=aj+Z,ag=ab+ae;if((Y+ai)>l){V=1;ad=(aj+(Z+1))}if((Y+ai)<1){var X=aa.prevMonth(),V=T(X.month(),X.year());(ad=aj+(Z-1))}if((ad)>12){ad=1;ag=(ab+(ae+1))}if((ad)<1){ad=12;ag=(ab+(ae-1))}var ac=T(ad,ag);V=(V>ac)?ac:V;return new P(ag,ad,V)}function H(W,V){if(!$.exists(W)||isNaN(W)){throw $.ku4exception("$.money",$.str.format("Invalid amount= {0}. Amount must be a number.",W))}H.base.call(this);var l=$.math.roundDown(W);this._cents=W-l;this._dollars=l;this._type=V||"$";this._value=W}H.prototype={cents:function(){return this._cents},dollars:function(){return this._dollars},type:function(){return this._type},value:function(){return this._value},add:function(l){money_checkType(this,l);return new H(this._value+l.value(),this._type)},divide:function(l){if(!$.isNumber(l)){throw $.ku4exception("$.money",$.str.format("Invalid divisor value= {0}",l))}return new H(this._value/l,this._type)},equals:function(l){return(this.isOfType(l))&&(this._value==l.value())},isOfType:function(l){return this._type==l.type()},isGreaterThan:function(l){money_checkType(this,l);return this._value>l.value()},isLessThan:function(l){money_checkType(this,l);return this._value<l.value()},multiply:function(l){if(!$.isNumber(l)){throw $.ku4exception("$.money",$.str.format("Invalid multiplier value= {0}",l))}return new H(this._value*l,this._type)},round:function(){return new H($.math.round(this.value(),-2),this._type)},roundDown:function(){return new H($.math.roundDown(this.value(),-2),this._type)},roundUp:function(){return new H($.math.roundUp(this.value(),-2),this._type)},subtract:function(l){money_checkType(this,l);return new H(this._value-l.value(),this._type)},toString:function(l,X){var W=(this.value<0)?"({0}{1}{2}{3})":"{0}{1}{2}{3}",V=X||".";return $.str.format(W,this._type,money_formatDollars(this,l),V,money_formatCents(this))}};$.Class.extend(H,$.Class);$.money=function(V,l){return new H(V,l)};$.money.Class=H;$.money.zero=function(l){return $.money(0,l)};$.money.isMoney=function(l){return l instanceof H};$.money.canParse=function(l){try{$.money.parse(l);return true}catch(V){return false}};$.money.parse=function(Z){if($.isNumber(Z)){return $.money(Z)}var l=/(\(.*\))|(\-)/.test(Z),Y=(l)?1:0,X=Z.match(/[^\d\.\,\-]/g)||[],W=$.exists(X[Y])?X[Y]:"$",aa=parseFloat(Z.replace(/[^\d\.]/g,"")),V=(l)?-aa:aa;return $.money(V,W)};$.money.tryParse=function(l){return $.money.canParse(l)?$.money.parse(l):null};money_checkType=function(V,l){if(!V.isOfType(l)){throw $.ku4exception("$.money",$.str.format("Invalid operation on non-conforming currencies. type: {0} != type: {1}",V._type,l._type))}};money_formatDollars=function(V,aa){var W=V.dollars(),Y=(V.cents()>=0.995)?(W+1):W,ae=Y.toString(),ab=ae.replace(/\-/,"").split(/\B/).reverse(),X=ab.length,ac=X>3,Z=0,ad=[];while(Z<X){ad[ad.length]=ab[Z];Z++;if(!$.exists(ab[Z])){break}if((Z%3==0)&&ac){ad[ad.length]=aa||","}}return $.str.build.apply(this,ad.reverse())};money_formatCents=function(X){var Y=$.math.round(X.cents(),-3),W=Y.toString(),Z=W.replace(/\-|(0\.)/g,"").concat("0").split(/\B/),V=Z.length;if($.isZero(V)||Y>=0.995){return"00"}if(V<2){return"0"+Z[0]}return(parseInt(Z[2])>4)?Z[0]+(parseInt(Z[1])+1):Z[0]+Z[1]};function t(l,V){if(!$.isNumber(l)||!$.isNumber(V)){throw $.ku4exception("$.coord",$.str.format("Invalid arguments x= {0}, y= {1} ",l,V))}t.base.call(this);this.x(l).y(V)}t.prototype={x:function(l){return this.property("x",l)},y:function(l){return this.property("y",l)},abs:function(){return new t(Math.abs(this._x),Math.abs(this._y))},add:function(V){var l=this._x+V.x(),W=this._y+V.y();return new t(l,W)},divide:function(V){var l=this._x/V.x(),W=this._y/V.y();return new t(l,W)},equals:function(l){return(this._x===l.x())&&(this._y===l.y())},multiply:function(V){var l=this._x*V.x(),W=this._y*V.y();return new t(l,W)},subtract:function(V){var l=this._x-V.x(),W=this._y-V.y();return new t(l,W)},round:function(l){var V=l||0;return new t($.math.round(this.x(),V),$.math.round(this.y(),V))},half:function(){return this.divide(new t(2,2))},value:function(){return{x:this._x,y:this._y}},toEm:function(){return D(this,"em")},toPixel:function(){return D(this,"px")},toString:function(){return $.str.format("({0},{1})",this._x,this._y)}};$.Class.extend(t,$.Class);$.coord=function(l,V){return new t(l,V)};$.coord.Class=t;function D(V,l){return{x:function(){return V.x()+l},y:function(){return V.y()+l}}}function F(l){try{if(("left" in l)&&("top" in l)){return !isNaN(l.left)&&!isNaN(l.top)}if(("width" in l)&&("height" in l)){return !isNaN(l.width)&&!isNaN(l.height)}return false}catch(V){return false}}function j(l){if(!$.exists(l)){return null}if($.exists(l.left)&&$.exists(l.top)){return new t(l.left,l.top)}if($.exists(l.width)&&$.exists(l.height)){return new t(l.width,l.height)}return null}$.coord.zero=function(){return new t(0,0)};$.coord.random=function(W,V){var l=W*Math.random(),X=V*Math.random(V);return new t(l,X)};$.coord.canParse=j;$.coord.parse=j;$.coord.tryParse=function(l){return F(l)?j(l):null};function C(l,V){C.base.call(this,l,V)}C.prototype={isAbove:function(l){return this.y()<l.y()},isBelow:function(l){return this.y()>l.y()},isLeftOf:function(l){return this.x()<l.x()},isRightOf:function(l){return this.x()>l.x()},distanceFrom:function(l){return $.vector(this.x()-l.x(),this.y()-l.y())},distanceTo:function(l){return this.distanceFrom(l).invert()}};$.Class.extend(C,$.coord.Class);$.point=function(l,V){return new C(l,V)};$.point.Class=C;$.point.zero=function(){return new C(0,0)};$.point.canParse=z;$.point.parse=a;$.point.tryParse=function(l){return z(l)?a(l):null};function z(l){try{return !isNaN(l.x())&&!isNaN(l.y())}catch(V){return false}}function a(l){return new C(l.x(),l.y())}function R(l,V){R.base.call(this);this._topLeft=$.point.parse(l);this._dims=$.point.parse(V);this._bottomRight=$.point.parse(l.add(V))}R.prototype={dims:function(){return this.get("dims")},topLeft:function(){return this.get("topLeft")},bottomRight:function(){return this.get("bottomRight")},center:function(){return this._topLeft.add(this._bottomRight.subtract(this._topLeft)).half()},contains:function(W){var V=this._topLeft,l=this._bottomRight;return V.isAbove(W)&&V.isLeftOf(W)&&l.isRightOf(W)&&l.isBelow(W)}};$.Class.extend(R,$.Class);$.rectangle=function(V,l){return new R(V,l)};$.rectangle.Class=R;function b(l,V){if(!$.isNumber(l)||!$.isNumber(V)){throw $.ku4exception("$.vector",$.str.format("Invalid arguments x= {0}, y= {1} ",l,V))}b.base.call(this,l,V);this._lengthSquared=c(this,l,V);this._length=s(this,this._lengthSquared);this._unitNormalX=E(this,l);this._unitNormalY=E(this,V)}b.prototype={magnitude:function(){return this.get("length")},equals:function(l){return(l instanceof b)&&((this._x===l.x())&&(this._y===l.y()))},normal:function(){return $.vector(this._unitNormalX,this._unitNormalY)},invert:function(){return $.vector(this.x()*-1,this.y()*-1)},norm:function(){return $.vector(Math.abs(this.x()),Math.abs(this.y()))},perpendicular:function(){return $.vector(this.y()*-1,this.x())},isZero:function(){return this.x()==0&&this.y()==0},add:function(l){return $.vector(this.x()+l.x(),this.y()+l.y())},dot:function(l){return(this.x()*l.x())+(this.y()*l.y())},perpendicularAtTo:function(l){var V=l.add(this.projectionOfOnto(l).invert());return $.vector(V.x(),V.y())},projectionOfOnto:function(l){var V=l.normal().scale(this.dot(l.normal()));return $.vector(V.x(),V.y())},scale:function(l){return $.vector((this.x()*l),(this.y()*l))},unitNormalDot:function(l){return(this.normal().x()*l.normal().x())+(this.normal().y()*l.normal().y())},reflect:function(l){if(l.isZero()){return this}var V=l.normal();return this.add(V.scale(2*(V.dot(this))).invert())},round:function(l){var V=l||0;return $.vector($.math.round(this.x(),V),$.math.round(this.y(),V))}};$.Class.extend(b,$.coord.Class);$.vector=function(l,V){return new b(l,V)};$.vector.Class=b;$.vector.zero=function(){return $.vector(0,0)};$.vector.random=function(W,V){var l=W*Math.random(),X=V*Math.random();return $.vector(l,X)};function s(l,V){if(l.isZero()){return 0}return Math.sqrt(V)}function c(V,l,W){if(V.isZero()){return 0}return Math.pow(l,2)+Math.pow(W,2)}function E(V,l){if(V.isZero()){return 0}return l/V.magnitude()}$.abstractContext=function(l){$.abstractContext.base.call(this);this.state(l)};$.abstractContext.prototype={state:function(l){if(!$.exists(l)){return this._state}return this.set("state",l.context(this))}};$.Class.extend($.abstractContext,$.Class);$.abstractState=function(l){$.abstractState.base.call(this);this.states(l)};$.abstractState.prototype={context:function(l){return this.property("context",l)},states:function(l){return this.set("states",l)},state:function(l){var V=this._context;V.state(new this._states[l](V));return this}};$.Class.extend($.abstractState,$.Class);$.abstractVisitor=function(){};$.abstractVisitor.prototype={$visit:function(){throw new Error("visit method is abstract an must be defined.")},subject:function(l){return this.property("subject",$.replicate(l))},visit:function(){return this.$visit()}};function v(l){v.base.call(this);this.$current=0;this._quit=false;this.subject(l)}v.prototype={$hasNext:function(){return $.exists(this._subject[this.$current+1])},$hasPrev:function(){return $.exists(this._subject[this.$current-1])},$each:function(V,W){var l=W||this;this.reset();do{V.call(l,this.current())}while(this.next()&&(!this._quit));this._end=false;this.reset()},$exec:function(W){var l=this._subject,V=l[W];if(!$.exists(V)){return null}this.$current=W;return V},subject:function(V){var l=($.isArray(V))?V:($.isObject(V))?k(V):V;if(!$.isUndefined(V)){this.reset()}this.$subject=l;return this.property("subject",l)},current:function(){return this.$exec(this.$current)},next:function(){return this.$exec(this.$current+1)},prev:function(){return this.$exec(this.$current-1)},hasNext:function(){return this.$hasNext()},hasPrev:function(){return this.$hasPrev()},reset:function(){this.$current=0;return this},quit:function(){return this.set("quit",true)},each:function(l,V){if(this._subject.length<1){return this}this.$each(l,V);return this}};function k(l){var V=[];for(n in l){V.push({key:n,value:l[n]})}return V}$.Class.extend(v,$.Class);$.iterator=function(l){return new v(l)};$.iterator.Class=v;function A(){A.base.call(this);this._observers=$.hash();this._throwErrors=0}A.prototype={throwErrors:function(){this._throwErrors=2;return this},logErrors:function(){this._throwErrors=1;return this},catchErrors:function(){this._throwErrors=0;return this},isEmpty:function(){return this._observers.isEmpty()},count:function(){return this._observers.count()},activeSubscriptionKeys:function(){return this._observers.keys()},subscribe:function(l,Y,V,X){var W=this._observers;if(W.containsKey(l)){W.find(l).add(Y,V,X)}else{W.add(l,$.observer().add(Y,V,X))}return this},unsubscribe:function(l,W){var V=this._observers;if(V.containsKey(l)){V.find(l).remove(W)}return this},notify:function(){var l=$.list.parseArguments(arguments),V=$.list(),W=$.list();l.each(function(X){if(this._observers.containsKey(X)){W.add(X)}else{V.add(X)}},this);return(W.isEmpty())?this._notifyAll(V.toArray()):this._notify(V.toArray(),W)},clear:function(){this._observers.each(function(l){l.value.clear()}).clear();return this},_notifyAll:function(l){$.list(this._observers.values()).each(function(V){V.notify.apply(V,l)});return this},_notify:function(W,V){var X=this._observers,l=this._throwErrors;V.each(function(Z){try{var Y=X.find(Z);Y.notify.apply(Y,W)}catch(ab){var aa=$.ku4exception("$.mediator",$.str.format("{0}. Subscriber key= {1}",ab.message,Z));if(l==2){throw aa}if(l==1){$.ku4Log(aa.message)}}});return this}};$.Class.extend(A,$.Class);$.mediator=function(){return new A()};$.mediator.Class=A;function B(){B.base.call(this);this._methods=new $.hash()}B.prototype={add:function(Y,V,X){var l=X||$.uid("observerMethod"),W=V||this;this._methods.add(l,{m:Y,s:W});return this},remove:function(l){this._methods.remove(l);return this},clear:function(){this._methods.clear();return this},notify:function(){var V=new $.iterator(this._methods.values()),l=arguments;V.each(function(W){if(!$.exists(W.m)){throw $.ku4exception("$.observer",$.str.format("Invalid or null method"))}W.m.apply(W.s,l)});return this},isEmpty:function(){return this._methods.isEmpty()}};$.Class.extend(B,$.Class);$.observer=function(){return new B()};$.observer.Class=B;function m(){this._q=[]}m.prototype={isEmpty:function(){return this._q.length==0},enqueue:function(l){var V=this._q;V[V.length]=l;return this},dequeue:function(){var V=this._q,l=V[0];V.splice(0,1);return l},clear:function(){this._q=[]}};$.fifo=function(){return new m()};$.fifo.Class=m;function I(l){I.base.call(this,l)}I.prototype={$hasNext:function(){var X=this.$subject,V=X.length-1,Z=this.$current,Y=Z+1,W=(Y>V)?0:Y;return $.exists(X[W])},$hasPrev:function(){var X=this.$subject,V=X.length-1,Z=this.$current,Y=Z+1,W=(Y<0)?V:Y;return $.exists(X[W])},$each:function(V,W){var l=W||this;this.reset();do{V.call(W,this.current())}while(this.next()&&(this.$current>0));this.reset()},$exec:function(X){var W=this.$subject,V=(W.length-1);this.$current=(X>V)?0:((X<0)?V:X);return W[this.$current]}};$.Class.extend(I,$.iterator.Class);$.rolodex=function(l){return new I(l)};$.rolodex.Class=I;function S(){}S.prototype={$isSatisfiedBy:function(l){return},isSatisfiedBy:function(l){return this.$isSatisfiedBy(l)},and:function(l){return new G(this,l)},or:function(l){return new o(this,l)},xor:function(l){return new y(this,l)},not:function(){return new O(this)}};function G(V,l){G.base.call(this);this.$1=V;this.$2=l}G.prototype.$isSatisfiedBy=function(l){return this.$1.isSatisfiedBy(l)&&this.$2.isSatisfiedBy(l)};$.Class.extend(G,S);function o(V,l){o.base.call(this);this.$1=V;this.$2=l}o.prototype.$isSatisfiedBy=function(l){return this.$1.isSatisfiedBy(l)||this.$2.isSatisfiedBy(l)};$.Class.extend(o,S);function y(V,l){y.base.call(this);this.$1=V;this.$2=l}y.prototype.$isSatisfiedBy=function(l){return $.xor(this.$1.isSatisfiedBy(l),this.$2.isSatisfiedBy(l))};$.Class.extend(y,S);function p(){p.base.call(this)}p.prototype.$isSatisfiedBy=function(l){return true};$.Class.extend(p,S);function h(){h.base.call(this)}h.prototype.$isSatisfiedBy=function(l){return false};$.Class.extend(h,S);function O(l){O.base.call(this);this._s=l}O.prototype.$isSatisfiedBy=function(l){return !this._s.isSatisfiedBy(l)};$.Class.extend(O,S);function r(l){r.base.call(this);this.$isSatisfiedBy=l}$.Class.extend(r,S);$.spec=function(l){return new r(l)};function x(){this._q=[]}x.prototype={isEmpty:function(){return this._q.length==0},push:function(l){var V=this._q;V[V.length]=l;return this},pop:function(){return this._q.pop()},clear:function(){this._q=[]}};$.lifo=function(){return new x()};$.lifo.Class=x})(jQuery);